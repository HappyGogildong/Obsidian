![[Pasted image 20260204030934.png]]
그림과 같은 예시를 학습시키고자 할 때 둘 중 어느 것이 더 바람직한 정답일까?
그 답은 오른쪽이다.

이 질문의 핵심은 모델이 학습하고 추론할 때 **왼쪽에서 오른쪽으로 1차원 토큰 시퀀스에서 작업**한다는 것이다.다음 토큰을 생성하기 위해 모든 토큰을 신경망에 넣고, 신경망이 다음 토큰에 대한 확률을 준다.

중요한 것은 여기서 일어나는 계산의 층 수가 유한하다는 것인데, 이 계산의 양은 시퀀스의 모든 개별 토큰에 대해 거의 고정되어 있다. 
따라서 개별 토큰에 유한한 양의 계산이 있기 때문에 많은 계산이 필요할 경우 개별 토큰에 많은 계산을 기대할 수 없고, 계산량을 모든 토큰에 분산해야한다.

그리고 왼쪽 예시를 보면, The answer is 다음에 바로 정답을 위한 토큰을 넣어야하는데, 
여기서 이 문제의 모든 계산을 이 토큰에 밀어넣어야 한다. 그 뒤에 3을 출력하고, 
그 다음에 출력하는 것은 왜 이것이 답인지에 대한 사후적 정당화다.

그래서 오른족처럼 천천히 답에 도달하도록 해야 한다. 중간 결과를 얻어야한다.
중간 계산을 만들어야하고 각 계산은 그렇게 비싸지 않다.
이렇게 추론을 펼치고 계산을 토큰에 분산하면 작업 메모리에 이전 결과들이 있어 정답을 결정하기 훨씬 쉬워진다. 그래서 오른쪽이 바람직한 레이블이다.

실제로 같은 문제에 "단일 토큰으로 질문에 답만 줘"라는 지침을 추가로 주면 답을 맞추지 못하는 경우가 있다.

이런 문제를 해결하는 방법은 코드를 사용하는 것이다.
"코드를 사용해"라고 하면 파이썬 등을 사용해 파이썬 인터프리터에 계산을 맡기고 답을 가져온다. 